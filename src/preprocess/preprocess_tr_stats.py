import pandas as pd

stat_cols = [
    "date",
    "team",
    "rankings_predictive_rating",
    "rankings_home_rating",
    "rankings_road_rating",
    "rankings_home_advantage_rating",
    "rankings_sos_rating",
    "rankings_sos_basic_rating",
    "rankings_luck_rating",
    "rankings_consistency_rating",
    "offense_scoring_points_per_game",
    "offense_scoring_points_per_game_delta",
    "offense_scoring_yards_per_point",
    "offense_scoring_yards_per_point_delta",
    "offense_scoring_points_per_play",
    "offense_scoring_points_per_play_margin",
    "offense_scoring_td_per_game",
    "offense_scoring_rz_attempts",
    "offense_scoring_rz_tds",
    "offense_scoring_rz_td_pcnt",
    "offense_scoring_ep_att",
    "offense_scoring_ep_made",
    "offense_scoring_2pt_att",
    "offense_scoring_2pt_made",
    "offense_scoring_points_per_fg",
    "offense_scoring_ep_pcnt",
    "offense_scoring_2pt_pcnt",
    "offense_scoring_off_td",
    "offense_scoring_def_td",
    "offense_scoring_spec_td",
    "offense_scoring_off_ppg",
    "offense_scoring_def_ppg",
    "offense_scoring_spec_ppg",
    "offense_scoring_point_share_pcnt",
    "offense_total_yards",
    "offense_total_plays",
    "offense_total_yards_per_play",
    "offense_total_1st_downs",
    "offense_total_3rd_downs",
    "offense_total_3rd_down_conversions",
    "offense_total_4th_downs",
    "offense_total_4th_down_conversions",
    "offense_total_time_of_possession",
    "offense_total_seconds_per_play",
    "offense_total_1st_downs_per_play",
    "offense_total_3rd_down_conversion_pcnt",
    "offense_total_4th_down_conversion_pcnt",
    "offense_total_punts_per_play",
    "offense_total_punts_per_score",
    "offense_total_opp_tackles",
    "offense_total_opp_solo_tackles",
    "offense_total_opp_asst_tackles",
    "offense_rushing_attempts",
    "offense_rushing_yds",
    "offense_rushing_1st_downs",
    "offense_rushing_tds",
    "offense_rushing_ypa",
    "offense_rushing_play_pcnt",
    "offense_rushing_td_pcnt",
    "offense_rushing_1st_down_pcnt",
    "offense_rushing_yards_pcnt",
    "offense_passing_attempts",
    "offense_passing_completions",
    "offense_passing_incompletions",
    "offense_passing_completion_pcnt",
    "offense_passing_yards",
    "offense_passing_yards_gross",
    "offense_passing_ypa",
    "offense_passing_ypc",
    "offense_passing_td",
    "offense_passing_td_pcnt",
    "offense_passing_sacks",
    "offense_passing_sack_pcnt",
    "offense_passing_1st_downs",
    "offense_passing_1st_down_pcnt",
    "offense_passing_pass_rtg",
    "offense_passing_play_pcnt",
    "offense_passing_yds_pcnt",
    "offense_special_teams_non_off_td",
    "offense_special_teams_fg_att",
    "offense_special_teams_fg_made",
    "offense_special_teams_fg_blocked",
    "offense_special_teams_kicking_ppg",
    "offense_special_teams_punts",
    "offense_special_teams_punts_blocked",
    "offense_special_teams_gross_punt_yards",
    "offense_special_teams_net_punt_yards",
    "offense_special_teams_kickoffs",
    "offense_special_teams_touchbacks",
    "offense_special_teams_kickoff_touchback_pcnt",
    "offense_special_teams_fg_made_pcnt_all",
    "offense_special_teams_fg_block_pcnt",
    "offense_special_teams_fg_made_pcnt",
    "offense_special_teams_punt_block_pcnt",
    "offense_special_teams_net_punt_ypa_all",
    "offense_special_teams_gross_punt_ypa",
    "offense_special_teams_net_punt_ypa",
    "defense_scoring_ppg",
    "defense_scoring_yards_per_point",
    "defense_scoring_points_per_play",
    "defense_scoring_tds",
    "defense_scoring_rz_attempts",
    "defense_scoring_rz_tds",
    "defense_scoring_rz_td_pcnt",
    "defense_scoring_ep_att",
    "defense_scoring_ep_made",
    "defense_scoring_2pt_att",
    "defense_scoring_2pt_made",
    "defense_scoring_points_per_fga",
    "defense_scoring_ep_pcnt",
    "defense_scoring_2pt_pcnt",
    "defense_scoring_off_td",
    "defense_scoring_def_td",
    "defense_scoring_spec_td",
    "defense_scoring_off_ppg",
    "defense_scoring_def_ppg",
    "defense_scoring_spec_ppg",
    "defense_scoring_point_share_pcnt",
    "defense_total_yards",
    "defense_total_plays",
    "defense_total_yards_per_play",
    "defense_total_1st_downs",
    "defense_total_3rd_downs",
    "defense_total_3rd_down_conversions",
    "defense_total_4th_downs",
    "defense_total_4th_down_conversions",
    "defense_total_time_of_possession",
    "defense_total_seconds_per_play",
    "defense_total_1st_downs_per_play",
    "defense_total_3rd_down_conversion_pcnt",
    "defense_total_4th_down_conversion_pcnt",
    "defense_total_punts_per_play",
    "defense_total_punts_per_score",
    "defense_total_tackles",
    "defense_total_solo_tackles",
    "defense_total_assisted_tackles",
    "defense_rushing_attempts",
    "defense_rushing_ypg",
    "defense_rushing_1st_downs",
    "defense_rushing_tds",
    "defense_rushing_ypa",
    "defense_rushing_play_pcnt",
    "defense_rushing_td_pcnt",
    "defense_rushing_1st_down_pcnt",
    "defense_rushing_yards_percent",
    "defense_passing_attempts",
    "defense_passing_completions",
    "defense_passing_incompletions",
    "defense_passing_completion_pcnt",
    "defense_passing_yards",
    "defense_passing_yards_gross",
    "defense_passing_ypa",
    "defense_passing_ypc",
    "defense_passing_1st_downs",
    "defense_passing_tds",
    "defense_passing_td_pcnt",
    "defense_passing_pass_rtg",
    "defense_passing_sack_pcnt",
    "defense_passing_play_pcnt",
    "defense_passing_yards_pcnt",
    "defense_passing_sacks",
    "defense_passing_1st_down_pcnt",
    "defense_special_teams_non_off_td",
    "defense_special_teams_fg_att",
    "defense_special_teams_fg_made",
    "defense_special_teams_fg_blocked",
    "defense_special_teams_kicking_ppg",
    "defense_special_teams_punts",
    "defense_special_teams_punts_blocked",
    "defense_special_teams_gross_punt_yards",
    "defense_special_teams_net_punt_yards",
    "defense_special_teams_kickoffs",
    "defense_special_teams_touchbacks",
    "defense_special_teams_kickoff_touchback_pcnt",
    "defense_special_teams_fg_made_pcnt_all",
    "defense_special_teams_fg_block_pcnt",
    "defense_special_teams_fg_made_pcnt",
    "defense_special_teams_punt_block_pcnt",
    "defense_special_teams_net_punt_ypa_all",
    "defense_special_teams_gross_punt_ypa",
    "defense_special_teams_net_punt_ypa",
    "off_turnovers_int",
    "off_turnovers_int_game_pcnt",
    "off_turnovers_fumbles",
    "off_turnovers_fumbles_lost",
    "off_turnovers_fumbles_not_lost",
    "off_turnovers_safeties",
    "off_turnovers_turnovers",
    "off_turnovers_turnover_margin",
    "off_turnovers_int_pcnt",
    "off_turnovers_fumble_rec_pcnt",
    "off_turnovers_giveaway_fumble_rec_pcnt",
    "off_turnovers_takeaway_fumble_rec_pcnt",
    "def_turnovers_int",
    "def_turnovers_int_game_pcnt",
    "def_turnovers_fumbles",
    "def_turnovers_fumbles_lost",
    "def_turnovers_fumbles_not_lost",
    "def_turnovers_safeties",
    "def_turnovers_takeaways",
    "def_turnovers_fumble_rec_pcnt",
    "def_turnovers_int_pcnt",
    "def_turnovers_opp_fumble_rec_pcnt",
    "def_turnovers_opp_giveaway_fumble_rec_pcnt",
    "def_turnovers_opp_takeaway_fumble_rec_pcnt",
    "penalties_penalties",
    "penalties_penalty_yards",
    "penalties_penalty_1st_downs",
    "penalties_yards_per_penalty",
    "penalties_penalty_rate",
    "penalties_opponent_penalties",
    "penalties_opponent_penalty_yards",
    "penalties_opponent_penalty_1st_downs",
    "penalties_opponent_yards_per_penalty",
    "penalties_opponent_penalty_rate",
]


def preprocess(df):
    df.columns = [col.replace("_last1", "") for col in df.columns]
    df = df[stat_cols].copy()
    df["date"] = pd.to_datetime(df["date"]).dt.tz_localize("UTC")
    df["offense_total_time_of_possession"].fillna("30:00", inplace=True)
    df["defense_total_time_of_possession"].fillna("30:00", inplace=True)
    for col in ["offense_total_time_of_possession", "defense_total_time_of_possession"]:
        df[["minutes", "seconds"]] = df[col].str.split(":", expand=True).astype(int)
        df[col] = df["minutes"] + df["seconds"] / 60
        df.drop(columns=["minutes", "seconds"], inplace=True)
    return df
